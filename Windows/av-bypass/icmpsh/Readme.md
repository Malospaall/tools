# Введение

icmpsh-client.c - оригинальный клиент с небольшими изменениями

Репозиторий представляет 

# Сервер

icmpsh-server.c - сервер переписанный на C

Установка

```bash
sudo apt install libsqlite3-dev uuid-dev
gcc icmpsh-server.c -o icmpsh -lsqlite3
```

В переменной `key`, в качестве ключа использовать любые символы кроме 0-9a-fA-F. Так как если в GUID и в ключе попадутся одинаковые символы, то в результате шифрования получится `\0` и шифрование оборвется

# Клиент

icmpsh-client-mod.c

1. Добавлено шифрование с помощью XOR, теперь команды не передаются в открытом виде.
2. Для массовой рассылки добавлена генерация GUID на стороне клиента чтобы отличать пользователей которые находятся в одной сети и выходят в Интернет с одного внешнего IP-адреса. Без данной реализации ICMP-протокол с несколькими клиентами работал некорректно.
3. Добавлена реализации функционала сессий, подобного Metasploit, а именно:
-  `set ExitOnSession false` - опция для `exploit/multi/handler` позволяющая принимать неограниченное количество сессий;
-  `exploit -j` - отправляет в фон новые сессии.

При компиляции клиента через Visual Studio, необходимо:
1. Перейти в настройки проекта -> Компоновщик (Linker) -> Ввод (Input)
    В дополнительные зависимости нужно добавить: `Rpcrt4.lib`
2. Перейти в настройки проекта -> Компоновщик (Linker) -> Система (System)
    В качестве подсистемы выбрать Windows
Эти шаги выполнить как для конфигурации Release, так и для Debug.

icmpsh-client-mod-message.c - версия, которая отображает сообщение об обновлении